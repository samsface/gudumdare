[gd_scene load_steps=14 format=3 uid="uid://dcnq1dkwqkvny"]

[ext_resource type="Script" path="res://battle/battle.gd" id="1_flom2"]
[ext_resource type="PackedScene" uid="uid://b2kvkq1htewf7" path="res://battle/units/tower_enemy.tscn" id="3_8e3ng"]
[ext_resource type="PackedScene" uid="uid://cwseclmja5rko" path="res://cards/hand.tscn" id="4_fjwei"]
[ext_resource type="PackedScene" uid="uid://tpek6s1ym3sk" path="res://battle/units/tower_player.tscn" id="5_mk8s6"]
[ext_resource type="AudioStream" uid="uid://cv02y62fsib0b" path="res://battle/sfx/lesgo_1.wav" id="8_r6yyu"]
[ext_resource type="AudioStream" uid="uid://rlljb2xw2447" path="res://battle/sfx/lesgo_2.wav" id="9_mdeoy"]
[ext_resource type="AudioStream" uid="uid://b0jv5sljkrk46" path="res://battle/sfx/lesgo_3.wav" id="10_vqf1s"]
[ext_resource type="AudioStream" uid="uid://djynsd3l0xs2t" path="res://battle/sfx/win.mp3" id="11_clmya"]
[ext_resource type="AudioStream" uid="uid://ck08d0au8mjrc" path="res://battle/units/sfx/applause.wav" id="12_liifm"]

[sub_resource type="StyleBoxEmpty" id="StyleBoxEmpty_jsvmk"]

[sub_resource type="BoxShape3D" id="BoxShape3D_xvlid"]
size = Vector3(10, 3, 0.01)

[sub_resource type="BoxShape3D" id="BoxShape3D_g4tkx"]
size = Vector3(19, 5, 0.01)

[sub_resource type="AudioStreamRandomizer" id="AudioStreamRandomizer_dfmjq"]
random_pitch = 1.1
streams_count = 3
stream_0/stream = ExtResource("8_r6yyu")
stream_0/weight = 1.0
stream_1/stream = ExtResource("9_mdeoy")
stream_1/weight = 1.0
stream_2/stream = ExtResource("10_vqf1s")
stream_2/weight = 1.0

[node name="Battle" type="Node2D"]
script = ExtResource("1_flom2")

[node name="CanvasLayer" type="CanvasLayer" parent="."]

[node name="Mana" type="ProgressBar" parent="CanvasLayer"]
unique_name_in_owner = true
modulate = Color(1, 0.345098, 1, 1)
offset_left = 24.0
offset_top = 758.0
offset_right = 1428.0
offset_bottom = 803.0
mouse_filter = 2
max_value = 10.0
show_percentage = false

[node name="ManaWhole" type="ProgressBar" parent="CanvasLayer"]
unique_name_in_owner = true
auto_translate_mode = 1
offset_left = 24.0
offset_top = 758.0
offset_right = 1428.0
offset_bottom = 803.0
mouse_filter = 2
theme_override_styles/background = SubResource("StyleBoxEmpty_jsvmk")
max_value = 10.0
show_percentage = false

[node name="ButtonQuit" type="Button" parent="CanvasLayer"]
offset_left = 33.0
offset_top = 23.0
offset_right = 111.0
offset_bottom = 83.0
text = "QUIT"

[node name="ColorRect" type="ColorRect" parent="."]
auto_translate_mode = 1
visible = false
offset_left = -23.0
offset_top = -18.0
offset_right = 1462.0
offset_bottom = 827.0
mouse_filter = 2

[node name="TextureRect" type="TextureRect" parent="ColorRect"]
layout_mode = 0
offset_right = 40.0
offset_bottom = 40.0

[node name="Deck" type="Node2D" parent="."]
visible = false
position = Vector2(706, 741)

[node name="Fight" type="Node2D" parent="."]
unique_name_in_owner = true
y_sort_enabled = true

[node name="TowerPlayer" parent="Fight" instance=ExtResource("5_mk8s6")]
unique_name_in_owner = true
position = Vector2(286, 418)

[node name="TowerEnemy" parent="Fight" instance=ExtResource("3_8e3ng")]
unique_name_in_owner = true
position = Vector2(1199, 455)

[node name="SubViewports" type="Control" parent="."]
layout_mode = 3
anchors_preset = 0
offset_right = 1441.0
offset_bottom = 809.0

[node name="SubViewportContainer" type="SubViewportContainer" parent="SubViewports"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = -73.0
offset_top = -26.0
offset_right = 73.0
offset_bottom = 26.0
grow_horizontal = 2
grow_vertical = 2
stretch = true

[node name="SubViewport" type="SubViewport" parent="SubViewports/SubViewportContainer"]
transparent_bg = true
handle_input_locally = false
physics_object_picking = true
size = Vector2i(1587, 861)
render_target_update_mode = 4

[node name="HandTest" type="Node3D" parent="SubViewports/SubViewportContainer/SubViewport"]

[node name="HandArea" parent="SubViewports/SubViewportContainer/SubViewport/HandTest" instance=ExtResource("4_fjwei")]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -1.05885, 0)
collision_layer = 2
collision_mask = 0
input_ray_pickable = false
sort = true

[node name="CollisionShape3D2" type="CollisionShape3D" parent="SubViewports/SubViewportContainer/SubViewport/HandTest/HandArea"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -1, 0.126)
shape = SubResource("BoxShape3D_xvlid")

[node name="BattleFieldArea" parent="SubViewports/SubViewportContainer/SubViewport/HandTest" instance=ExtResource("4_fjwei")]
transform = Transform3D(1, 0, 0, 0, 0.965926, 0.258819, 0, -0.258819, 0.965926, -1.32559, 1.43344, -0.51066)
collision_layer = 2
collision_mask = 0
input_ray_pickable = false

[node name="CollisionShape3D" type="CollisionShape3D" parent="SubViewports/SubViewportContainer/SubViewport/HandTest/BattleFieldArea"]
transform = Transform3D(1, 0, 0, 0, 1, -1.49012e-08, 0, 1.49012e-08, 1, 0, 0.418104, -0.558491)
shape = SubResource("BoxShape3D_g4tkx")

[node name="Camera3D" type="Camera3D" parent="SubViewports/SubViewportContainer/SubViewport/HandTest"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.150354, 1.934)
fov = 70.0

[node name="RayCast3D" type="RayCast3D" parent="SubViewports/SubViewportContainer/SubViewport/HandTest/Camera3D"]
target_position = Vector3(0, 0, 0)
collision_mask = 2
collide_with_areas = true
collide_with_bodies = false

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="SubViewports/SubViewportContainer/SubViewport/HandTest"]
transform = Transform3D(0.846164, -0.191518, 0.497321, 0.165112, 0.981489, 0.0970424, -0.506701, 0, 0.862122, 0, 0.658451, 3.06358)
shadow_enabled = true
shadow_bias = 0.044
shadow_normal_bias = 5.7
shadow_opacity = 0.45
shadow_blur = 0.736

[node name="NewCardSpawn" type="Marker3D" parent="SubViewports/SubViewportContainer/SubViewport/HandTest"]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.00959778, -1.37475, 0)

[node name="Camera2D" type="Camera2D" parent="."]
unique_name_in_owner = true
position = Vector2(720, 405)

[node name="AudioLetsGo" type="AudioStreamPlayer" parent="."]
stream = SubResource("AudioStreamRandomizer_dfmjq")
pitch_scale = 0.8
bus = &"Echo"

[node name="AudioWin" type="AudioStreamPlayer" parent="."]
stream = ExtResource("11_clmya")
pitch_scale = 1.2
bus = &"Echo"

[node name="AudioApplause" type="AudioStreamPlayer" parent="."]
stream = ExtResource("12_liifm")
bus = &"Chorus"

[connection signal="pressed" from="CanvasLayer/ButtonQuit" to="." method="_on_button_quit_pressed"]
[connection signal="died" from="Fight/TowerEnemy" to="." method="_tower_enemy_died"]
[connection signal="child_entered_tree" from="SubViewports/SubViewportContainer/SubViewport/HandTest/BattleFieldArea" to="." method="_battle_field_area_child_entered_tree"]
